<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.9" DspName="Microsoft.Data.Tools.Schema.Sql.Sql130DatabaseSchemaProvider" CollationLcid="1058" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="130" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="Book_Library_Data_Base.dll" />
			<Metadata Name="FileName" Value="D:\ROOT\DOCUMENTS\PROJECTS\BOOK LIBRARY PROJECT\BOOK LIBRARY .NET CORE WPF SOLUTION\BOOK LIBRARY DATA BASE\OBJ\DEBUG\BOOK_LIBRARY_DATA_BASE.DLL" />
			<Metadata Name="AssemblyName" Value="Book_Library_Data_Base" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="D:\ROOT\Documents\Projects\Book Library Project\Book Library .NET Core WPF Solution\Book Library Data Base\obj\Debug\Book_Library_Data_Base.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="Ukrainian_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Property Name="QueryStoreStaleQueryThreshold" Value="367" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="3" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="4" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Profiles].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Profiles]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="5" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[BookTracking].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[BooksAuthors].[BookId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[BooksAuthors].[AuthorId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Books].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Authors].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Accounts].[Login]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlUniqueConstraint">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[Accounts].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Accounts]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Accounts].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Accounts].[Login]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Accounts].[Password]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="16" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Accounts].[ProfileId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="10" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
			<AttachedAnnotation Disambiguator="11" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[AddAuthors]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @Author as NVARCHAR (64);
	
	DECLARE @AuthorCursor as CURSOR;
	
	SET @AuthorsString = dbo.CustomTrim(@AuthorsString, ' ');
	SET @AuthorsString = dbo.CustomTrim(@AuthorsString, ',');
	SET @AuthorCursor = CURSOR FOR
	SELECT value FROM STRING_SPLIT(@AuthorsString, ',');
	
	OPEN @AuthorCursor;
	
	FETCH NEXT FROM @AuthorCursor INTO @Author;
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SET @Author = dbo.CustomTrim(@Author, ' ');
		IF NOT EXISTS (SELECT * FROM Authors 
                   WHERE Name = @Author)
		BEGIN
			Insert into Authors (Name) values(@Author) 
		END
	 FETCH NEXT FROM @AuthorCursor INTO @Author;
	END
	CLOSE @AuthorCursor;
	DEALLOCATE @AuthorCursor;

RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[cursor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddAuthors].[@AuthorsString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CustomTrim]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[Name]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddAuthors].[@AuthorsString]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="778" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[AddAuthors]&#xD;&#xA;&#x9;@AuthorsString NVARCHAR (1024)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[AddBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
		EXEC dbo.AddAuthors @AuthorsString = @Authors;

	while (@Quantity > 0) 
	begin
		Insert into Books (Name, Year) values(@Name, @Year); 
		set @Quantity = @Quantity - 1;
		
			DECLARE @BookId AS INT;
			SET @BookId = IDENT_CURRENT('Books');
		
			EXEC dbo.BindBookAuthors @BookId = @BookId, @Authors = @Authors;
	end 
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddAuthors].[@AuthorsString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBook].[@Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBook].[@Quantity]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBook].[@Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBook].[@Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@Authors]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBook].[@Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBook].[@Authors]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBook].[@Year]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBook].[@Quantity]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="477" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[AddBook]&#xD;&#xA;&#x9;@Name NVARCHAR (64),&#xD;&#xA;&#x9;@Authors nvarchar (1024) = NULL,&#xD;&#xA;&#x9;@Year DATETIME,&#xD;&#xA;&#x9;@Quantity INT = 1&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[AddBookAuthor]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	IF NOT EXISTS (SELECT * FROM BooksAuthors 
                   WHERE BookId = @BookId AND AuthorId = @AuthorId)
	BEGIN
		Insert into BooksAuthors (BookId, AuthorId) values(@BookId, @AuthorId);
	END
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBookAuthor].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddBookAuthor].[@AuthorId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBookAuthor].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[AddBookAuthor].[@AuthorId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="288" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[AddBookAuthor]&#xD;&#xA;&#x9;@BookId INT,&#xD;&#xA;&#x9;@AuthorId INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Authors]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Authors].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Authors].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[BindBookAuthors]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	
	DECLARE @Author as NVARCHAR (64);
	DECLARE @AuthorId as INT;
	
	DECLARE @AuthorCursor as CURSOR;
	
	
	SET @Authors = dbo.CustomTrim(@Authors, ' ');
	SET @Authors = dbo.CustomTrim(@Authors, ',');
	SET @AuthorCursor = CURSOR FOR
	SELECT value FROM STRING_SPLIT(@Authors, ',');
	
	OPEN @AuthorCursor;
	
	FETCH NEXT FROM @AuthorCursor INTO @Author;
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SET @Author = dbo.CustomTrim(@Author, ' ');
		SELECT TOP 1 @AuthorId = ID
		FROM Authors
		WHERE Name = @Author
		ORDER BY ID ASC;
		
		IF @AuthorId IS NOT NULL
		BEGIN
			IF NOT EXISTS (SELECT * FROM BooksAuthors 
					   WHERE BookId = @BookId AND AuthorId = @AuthorId)
			BEGIN
				Insert into BooksAuthors (BookId, AuthorId) values(@BookId, @AuthorId) 
			END
			FETCH NEXT FROM @AuthorCursor INTO @Author;
		END
	END
	CLOSE @AuthorCursor;
	DEALLOCATE @AuthorCursor;
	
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[cursor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CustomTrim]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BindBookAuthors].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[BindBookAuthors].[@Authors]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="990" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[BindBookAuthors]&#xD;&#xA;&#x9;@BookId INT,&#xD;&#xA;&#x9;@Authors nvarchar (1024)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Books]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Books].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Books].[Name]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Books].[Year]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Books].[Availability]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="4" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="8" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[BooksAuthors]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BooksAuthors].[BookId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BooksAuthors].[AuthorId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="7" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[BookTracking]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BookTracking].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BookTracking].[BookId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BookTracking].[AccountId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BookTracking].[ActionTime]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[BookTracking].[Action]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="3" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="6" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[CanPutBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	DECLARE @LastGetUserId INT;

	SELECT @LastGetUserId = Result.AccountId FROM
	(SELECT AccountId, MAX(ActionTime) as LastTakeDateTime FROM BookTracking
	WHERE BookId = @BookId AND Action = 1
	GROUP BY AccountId) as Result;

	IF (@AccountId = @LastGetUserId)
	BEGIN
		SET @Result = 1;
	END
	ELSE 
	BEGIN
		SET @Result = 0;
	END
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[ActionTime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CanPutBook].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CanPutBook].[@AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CanPutBook].[@Result]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CanPutBook].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CanPutBook].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CanPutBook].[@Result]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="449" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[CanPutBook]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@BookId INT,&#xD;&#xA;&#x9;@Result BIT OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ChangeAccountPassword]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	SET @Result = 0;
	DECLARE @AccountPassword NVARCHAR (32);
	SELECT @AccountPassword = Password
	FROM Accounts
	WHERE ID = @AccountId;

	IF (@AccountPassword = @Password)
	BEGIN
		UPDATE Accounts
		SET Password = @NewPassword
		WHERE ID = @AccountId;
		SET @Result = 1;
	END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ChangeAccountPassword].[@Result]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ChangeAccountPassword].[@AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ChangeAccountPassword].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[ChangeAccountPassword].[@NewPassword]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ChangeAccountPassword].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ChangeAccountPassword].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ChangeAccountPassword].[@NewPassword]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[ChangeAccountPassword].[@Result]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="628" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[ChangeAccountPassword]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@Password NVARCHAR (32),&#xD;&#xA;&#x9;@NewPassword NVARCHAR (32),&#xD;&#xA;&#x9;@Result BIT OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[ClearAuthors]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @AuthorId as INT;
	
	DECLARE @AuthorCursor as CURSOR;
	
	SET @AuthorCursor = CURSOR FOR
	SELECT ID FROM Authors;
	
	OPEN @AuthorCursor;
	
	FETCH NEXT FROM @AuthorCursor INTO @AuthorId;
	WHILE @@FETCH_STATUS = 0
	BEGIN
		IF NOT EXISTS (SELECT * FROM BooksAuthors 
                   WHERE AuthorId = @AuthorId)
		BEGIN
			DELETE FROM Authors WHERE ID = @AuthorId;
		END
		FETCH NEXT FROM @AuthorCursor INTO @AuthorId;
	END
	CLOSE @AuthorCursor;
	DEALLOCATE @AuthorCursor;
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[cursor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="554" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[ClearAuthors]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[CustomTrim]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CustomTrim].[@String]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CustomTrim].[@TrimChar]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[ 
BEGIN
	DECLARE @Result NVARCHAR(MAX);
	SET @Result = @String;
	
	IF( LEN(@Result) > 1)
		BEGIN
		WHILE SUBSTRING(@Result, 1, 1) = @TrimChar
		BEGIN
			SET @Result = SUBSTRING(@Result, 2, LEN(@Result) - 1)
		END
	
		WHILE SUBSTRING(@Result, LEN(@Result), 1) = @TrimChar
		BEGIN
			SET @Result = SUBSTRING(@Result, 1, LEN(@Result) - 1)
		END
	END
	
	RETURN (@Result);
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="2" />
							<Property Name="Length" Value="526" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="&#xD;&#xA;create FUNCTION [dbo].[CustomTrim]&#xD;&#xA;(&#xD;&#xA;&#x9;@String NVARCHAR(MAX),&#xD;&#xA;&#x9;@TrimChar NCHAR(1)&#xD;&#xA;)&#xD;&#xA;RETURNS NVARCHAR(MAX)&#xD;&#xA;WITH SCHEMABINDING &#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CustomTrim].[@String]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[CustomTrim].[@TrimChar]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="IsMax" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[DeleteAccount]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	SET @Result = 0;
	DECLARE @AccountPassword NVARCHAR (32);
	SELECT @AccountPassword = Password
	FROM Accounts
	WHERE ID = @AccountId;

	IF (@AccountPassword = @Password)
	BEGIN
		DELETE FROM Accounts WHERE ID = @AccountId; 
		SET @Result = 1;
	END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[DeleteAccount].[@Result]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[DeleteAccount].[@AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[DeleteAccount].[@Password]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[DeleteAccount].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[DeleteAccount].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[DeleteAccount].[@Result]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="194" />
				<Property Name="Length" Value="562" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[DeleteAccount]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@Password NVARCHAR (32),&#xD;&#xA;&#x9;@Result BIT OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[DeleteBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	delete from Books where ID = @ID
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[DeleteBook].[@ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[DeleteBook].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="96" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[DeleteBook]&#xD;&#xA;&#x9;@ID INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_AccountsProfiles]">
			<Property Name="OnUpdateAction" Value="1" />
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[Accounts].[ProfileId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Profiles].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Profiles]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_BooksAuthorsAuthorId]">
			<Property Name="OnUpdateAction" Value="1" />
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Authors].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="13" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_BooksAuthorsBookId]">
			<Property Name="OnUpdateAction" Value="1" />
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_BookTrackingAccountId]">
			<Property Name="OnUpdateAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_BookTrackingBookId]">
			<Property Name="OnUpdateAction" Value="1" />
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="16" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT ID, Name, Authors = dbo.JoinBookAuthors(@BookID), Year, Availability
	FROM Books
	WHERE ID = @BookID
	ORDER BY ID DESC;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetBook].[@BookID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetBook].[@BookID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="197" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBook]&#xD;&#xA;&#x9;@BookID INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBooks]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT ID, Name, Authors = dbo.JoinBookAuthors(ID), Year, Availability
	FROM Books
	ORDER BY ID DESC;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="158" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBooks]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBooksAvaliable]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT ID, Name, Authors = dbo.JoinBookAuthors(ID), Year, Availability
	FROM Books
	WHERE Availability = 1
	ORDER BY Name
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="188" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBooksAvaliable]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBooksAvaliableDistinct]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT min(ID) AS ID, Name, Authors, Year, Availability
	FROM (SELECT ID, Name, Authors = dbo.JoinBookAuthors(ID), Year, Availability
	FROM Books) AS T
	WHERE Availability = 1
	GROUP BY Name, Authors, Year, Availability;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="296" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBooksAvaliableDistinct]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBooksByAccount]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT ID, Name, Authors = dbo.JoinBookAuthors(ID), Year, Availability
	FROM
		(
		SELECT BookId, MAX(ActionTime) AS ActionTime
		FROM BookTracking
		WHERE Action = 1 AND AccountId = 1
		GROUP BY BookId
		) AS BooksV
	INNER JOIN Books
	ON BooksV.BookId = Books.ID
	WHERE Availability = 0
	ORDER BY BooksV.ActionTime
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[ActionTime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetBooksByAccount].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="407" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBooksByAccount]&#xD;&#xA;&#x9;@AccountId INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBooksDistinct]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT min(ID) AS ID, Name, Authors, Year, MAX(convert(TINYINT,Availability)) AS 'Availability'
	FROM (SELECT ID, Name, Authors = dbo.JoinBookAuthors(ID), Year, Availability
	FROM Books) AS T
	GROUP BY Name, Authors, Year;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[tinyint]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="288" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBooksDistinct]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetBookTrack]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	IF (@TracksCount = 'All')
	BEGIN
		SELECT BookId, Name AS BookName, Login, ActionTime, Action
		FROM 
			(SELECT * from dbo.BookTracking where BookId = @BookID) as TrackV
			INNER JOIN
			dbo.Books as BookV ON  BookV.ID = TrackV.BookId
			INNER JOIN
			dbo.Accounts AS AccountV ON AccountV.ID = TrackV.AccountId
		ORDER BY ActionTime DESC;
	END;
	ELSE
	BEGIN
		DECLARE @TCount INT;
		
		SET @TCount = CASE WHEN TRY_CAST(@TracksCount AS INT) IS NULL
						THEN 10
						ELSE CAST(@TracksCount AS INT)
						END;
		SELECT TOP(@TCount) BookId, Name AS BookName, Login, ActionTime, Action
		FROM 
			(SELECT * from dbo.BookTracking where BookId = @BookID) as TrackV
			INNER JOIN
			dbo.Books as BookV ON  BookV.ID = TrackV.BookId
			INNER JOIN
			dbo.Accounts AS AccountV ON AccountV.ID = TrackV.AccountId
		ORDER BY ActionTime DESC;
	END;
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetBookTrack].[@TracksCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetBookTrack].[@BookID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[ActionTime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetBookTrack].[@BookID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetBookTrack].[@TracksCount]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="965" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetBookTrack]&#xD;&#xA;&#x9;@BookID INT,&#xD;&#xA;&#x9;@TracksCount NVARCHAR(10)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[GetUser]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SELECT 
			@Login = Accounts.Login,
			@FirstName = ProfilesV.FirstName,
			@LastName = ProfilesV.LastName,
			@Email = ProfilesV.Email
	FROM 
	Accounts
	INNER JOIN
	Profiles AS ProfilesV ON Accounts.ProfileId = ProfilesV.ID
	WHERE Accounts.ID = @AccountId

END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ProfileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetUser].[@Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetUser].[@FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetUser].[@LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetUser].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[GetUser].[@AccountId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetUser].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetUser].[@Login]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetUser].[@FirstName]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetUser].[@LastName]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[GetUser].[@Email]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="465" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[GetUser]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@Login NVARCHAR(32) OUTPUT,&#xD;&#xA;&#x9;@FirstName NVARCHAR(32) OUTPUT,&#xD;&#xA;&#x9;@LastName NVARCHAR(32) OUTPUT,&#xD;&#xA;&#x9;@Email NVARCHAR(32) OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[dbo].[JoinBookAuthors]">
			<Property Name="IsSchemaBound" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[cursor]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[JoinBookAuthors].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[AuthorId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Authors].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[CustomTrim]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[ 
BEGIN
	DECLARE @Result NVARCHAR(MAX);
	SET @Result = '';

	DECLARE @Author as NVARCHAR (64);
	
	DECLARE @AuthorCursor as CURSOR;
	
	SET @AuthorCursor = CURSOR FOR
	SELECT Name FROM 
		(SELECT AuthorId from dbo.BooksAuthors where BookId = @BookId) as BooksAuthorsV
		INNER JOIN
		dbo.Authors ON  BooksAuthorsV.AuthorId = Authors.ID
	ORDER BY Name;
	
	OPEN @AuthorCursor;
	
	FETCH NEXT FROM @AuthorCursor INTO @Author;
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SET @Result = @Result + @Author + ', ';
		FETCH NEXT FROM @AuthorCursor INTO @Author;
	END
	CLOSE @AuthorCursor;
	DEALLOCATE @AuthorCursor;

	SET @Result = dbo.CustomTrim(@Result, ' ');
	SET @Result = dbo.CustomTrim(@Result, ',');

	RETURN (@Result);
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="2" />
							<Property Name="Length" Value="848" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE FUNCTION [dbo].[JoinBookAuthors]&#xD;&#xA;(&#xD;&#xA;&#x9;@BookId INT&#xD;&#xA;)&#xD;&#xA;RETURNS NVARCHAR(MAX)&#xD;&#xA;WITH SCHEMABINDING &#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[JoinBookAuthors].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="IsMax" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[LoginAccount]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DECLARE @AccountId INT;
	SET @AccountId = 0;
	SELECT @AccountId = ID
	FROM Accounts
	WHERE Login = @Login
	AND Password = @Password;
SET @Result = @AccountId]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LoginAccount].[@Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LoginAccount].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[LoginAccount].[@Result]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LoginAccount].[@Login]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LoginAccount].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[LoginAccount].[@Result]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="281" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[LoginAccount]&#xD;&#xA;&#x9;@Login NVARCHAR (64),&#xD;&#xA;&#x9;@Password NVARCHAR (32),&#xD;&#xA;&#x9;@Result INT OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[Profiles]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Profiles].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Profiles].[FirstName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Profiles].[LastName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[Profiles].[Email]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="5" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[PutBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	IF EXISTS (SELECT ID FROM Accounts WHERE ID = @AccountId)
	BEGIN
		IF EXISTS (SELECT ID FROM Books WHERE ID = @BookId)
		BEGIN
			DECLARE @Availability BIT;
			SELECT @Availability = Availability FROM Books WHERE ID = @BookId;
			IF (@Availability <> 1)
			BEGIN
				INSERT INTO BookTracking (BookId, AccountId, ActionTime, Action)
				VALUES (@BookId, @AccountId, CURRENT_TIMESTAMP, 0);
				UPDATE Books
				SET Availability = 1
				WHERE ID = @BookID
			END
		END
	END
	UPDATE Books
	SET Availability = 1
	WHERE ID = @BookID
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PutBook].[@AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[PutBook].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[ActionTime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[PutBook].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[PutBook].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="630" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[PutBook]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@BookId INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[RegisterAccount]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	IF NOT EXISTS (SELECT * FROM Accounts 
                   WHERE Login = @Login
				   )
	BEGIN
		DECLARE @ProfileId INT;
		DECLARE @AccountId INT;
		SET @ProfileId = NULL
		SELECT TOP 1 @ProfileId = ID
		FROM Profiles
		WHERE FirstName = @FirstName 
			AND LastName = @LastName
			AND Email = @Email
		ORDER BY ID ASC;
		IF @ProfileId IS NOT NULL
		BEGIN
			INSERT INTO Accounts (Login, Password, ProfileId)
			VALUES (@Login, @Password, @ProfileId);
			SET @AccountId = IDENT_CURRENT('Accounts');
		END
		ELSE
		BEGIN
			INSERT INTO Profiles (FirstName, LastName, Email)
			VALUES (@FirstName, @LastName, @Email);
			SET @ProfileId = IDENT_CURRENT('Profiles');
			INSERT INTO Accounts (Login, Password, ProfileId)
			VALUES (@Login, @Password, @ProfileId);
			SET @AccountId = IDENT_CURRENT('Accounts');
		END
		SET @Result = @AccountId
	END 
	ELSE
	BEGIN
		SET @Result = -1
	END
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@FirstName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@LastName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Profiles].[Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@Email]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Login]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ProfileId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@Password]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[RegisterAccount].[@Result]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@Login]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@Password]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@FirstName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@LastName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@Email]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="32" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[RegisterAccount].[@Result]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="1123" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[RegisterAccount]&#xD;&#xA;&#x9;@Login NVARCHAR (64),&#xD;&#xA;&#x9;@Password NVARCHAR (32),&#xD;&#xA;&#x9;@FirstName NVARCHAR (64),&#xD;&#xA;&#x9;@LastName NVARCHAR (64),&#xD;&#xA;&#x9;@Email NVARCHAR (32),&#xD;&#xA;&#x9;@Result INT OUTPUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[TakeBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	IF EXISTS (SELECT ID FROM Accounts WHERE ID = @AccountId)
	BEGIN
		IF EXISTS (SELECT ID FROM Books WHERE ID = @BookId)
		BEGIN
			DECLARE @Availability BIT;
			SELECT @Availability = Availability FROM Books WHERE ID = @BookId;
			IF (@Availability <> 0)
			BEGIN
				INSERT INTO BookTracking (BookId, AccountId, ActionTime, Action)
				VALUES (@BookId, @AccountId, CURRENT_TIMESTAMP, 1);
				UPDATE Books
				SET Availability = 0
				WHERE ID = @BookID
			END
		END
	END
END;]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bit]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Accounts].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TakeBook].[@AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[TakeBook].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Availability]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[AccountId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[ActionTime]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BookTracking].[Action]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TakeBook].[@AccountId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[TakeBook].[@BookId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="572" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[TakeBook]&#xD;&#xA;&#x9;@AccountId INT,&#xD;&#xA;&#x9;@BookId INT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UpdateBook]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	UPDATE Books
	SET Name = @NewName,
		Year = @NewYear
	WHERE ID = @ID
	
	EXEC dbo.UpdateBookAuthors @BookID = @ID, @NewAuthors = @NewAuthors;
	
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[Books]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Name]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBook].[@NewName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[Year]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBook].[@NewYear]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[Books].[ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBook].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBookAuthors].[@BookID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBookAuthors].[@NewAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBook].[@NewAuthors]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBook].[@ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBook].[@NewName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="64" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBook].[@NewAuthors]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBook].[@NewYear]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="295" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[UpdateBook]&#xD;&#xA;&#x9;@ID INT,&#xD;&#xA;&#x9;@NewName NVARCHAR(64),&#xD;&#xA;&#x9;@NewAuthors NVARCHAR(1024) = NULL,&#xD;&#xA;&#x9;@NewYear DATETIME&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[UpdateBookAuthors]">
			<Property Name="BodyScript">
				<Value><![CDATA[
	DELETE FROM BooksAuthors WHERE BookId = @BookID;
	
		EXEC dbo.AddAuthors @AuthorsString = @NewAuthors;
		EXEC dbo.BindBookAuthors @BookId = @BookID, @Authors = @NewAuthors;
RETURN 0]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[BooksAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BooksAuthors].[BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBookAuthors].[@BookID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[AddAuthors].[@AuthorsString]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[UpdateBookAuthors].[@NewAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@BookId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[BindBookAuthors].[@Authors]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBookAuthors].[@BookID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[UpdateBookAuthors].[@NewAuthors]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1024" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="2" />
				<Property Name="Length" Value="287" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;CREATE PROCEDURE [dbo].[UpdateBookAuthors]&#xD;&#xA;&#x9;@BookID INT,&#xD;&#xA;&#x9;@NewAuthors NVARCHAR(1024) = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
	</Model>
</DataSchemaModel>